1. Create a new directory in linux namely ~/install/hdfsusecases and create a new file inside the above directory
namely ~/install/hdfsusecases/NYSE_2020_06_20.txt copying the first 1000 lines from an existing file
~/pigdata/NYSE_daily

Ans:
mkdir ~/install/hdfsusecases
head -1000 ~/hive/data/txns_20181213_NY >> ~/install/hdfsusecases/NYSE_2020_06_20.txt


2. Create another new file inside the above directory namely ~/install/hdfsusecases/NYSE_2020_06_21.txt copying
the line from 1001 to 2000 from an existing file ~/pigdata/NYSE_daily

Ans : 
sed -n '1001,2000p' ~/hive/data/txns_20181213_NY > ~/install/hdfsusecases/NYSE_2020_06_21.txt


3. Create a directory in Hadoop namely /tmp/hdfsusecases

Ans :
hadoop fs -mkdir -p /tmp/hdfsusecases


4. Check whether the above directory is created in HDFS or not using the below command (Note: We use –test –d
option to check whether the given path is a directory or not)
hadoop fs -test -d /tmp/hdfsusecases

Ans:
hadoop fs -test -d /tmp/hdfsusecases


5. Check what is the status code of the above command using, if it shows 0 then directory is created, if shows non
zero then the directory is not created then check the step 3 again.
echo $?

Ans:
echo $?  ---> 0



6. Copy file generated only in step 1 (~/install/hdfsusecases/NYSE_2020_06_20.txt) from linux to hdfs directory
/tmp/hdfsusecases in the name of NYSE_2020_06.txt

Ans:
hadoop dfs -copyFromLocal /home/hduser/install/hdfsusecases/NYSE_2020_06_20.txt /tmp/hdfsusecases/NYSE_2020_06.txt


7. Like step 4 and 5, check whether the above file (/tmp/hdfsusecases/NYSE_2020_06.txt) is created or not in HDFS,
using -f option and check for the status code using $? and create a zero byte file in HDFS directory
/tmp/hdfsusecases in the name of _SUCCESS

Ans:
hadoop fs -test -d /tmp/hdfsusecases
echo $?


8. Append the file generated in step 2 in linux (~/install/hdfsusecases/NYSE_2020_06_20.txt) with the file generated
in step 6 in the hdfs directory /tmp/hdfsusecases/NYSE_2020_06.txt

Ans:
hadoop fs -appendToFile /home/hduser/install/hdfsusecases/NYSE_2020_06_21.txt /tmp/hdfsusecases/NYSE_2020_06.txt


9. Count the size of the file in HDFS /tmp/hdfsusecases/NYSE_2020_06.txt

Ans:
[hduser@localhost hdfsusecases]$ hadoop fsck /tmp/hdfsusecases/NYSE_2020_06.txt
DEPRECATED: Use of this script to execute hdfs command is deprecated.
Instead use the hdfs command for it.

22/06/29 20:19:38 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Connecting to namenode via http://localhost:50070/fsck?ugi=hduser&path=%2Ftmp%2Fhdfsusecases%2FNYSE_2020_06.txt
FSCK started by hduser (auth:SIMPLE) from /127.0.0.1 for path /tmp/hdfsusecases/NYSE_2020_06.txt at Wed Jun 29 20:19:41 IST 2022
.Status: HEALTHY
 Total size:	176250 B
 Total dirs:	0
 Total files:	1
 Total symlinks:		0
 Total blocks (validated):	1 (avg. block size 176250 B)
 Minimally replicated blocks:	1 (100.0 %)
 Over-replicated blocks:	0 (0.0 %)
 Under-replicated blocks:	0 (0.0 %)
 Mis-replicated blocks:		0 (0.0 %)
 Default replication factor:	1
 Average block replication:	1.0
 Corrupt blocks:		0
 Missing replicas:		0 (0.0 %)
 Number of data-nodes:		1
 Number of racks:		1
FSCK ended at Wed Jun 29 20:19:41 IST 2022 in 5 milliseconds


The filesystem under path '/tmp/hdfsusecases/NYSE_2020_06.txt' is HEALTHY


10. Count the number of rows are there in the /tmp/hdfsusecases/NYSE_2020_06.txt (Which should show the total
count of the files created in step1 and 2)

Ans:

[hduser@localhost hdfsusecases]$ hadoop fs -cat /tmp/hdfsusecases/NYSE_2020_06.txt | wc -l
22/06/29 20:34:21 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2000


11. Display only line 11 to 20 from the file in HDFS /tmp/hdfsusecases/NYSE_2020_06.txt

Ans:
hadoop fs -cat /tmp/hdfsusecases/NYSE_2020_06.txt | sed -n '11,20d'


12. Store line 11 to 20 from the file in HDFS /tmp/hdfsusecases/NYSE_2020_06.txt into linux file namely
~/install/hdfsusecases/NYSE_sampledata1.txt

Ans : 
hadoop fs -cat /tmp/hdfsusecases/NYSE_2020_06.txt | head -20 | tail -10 >> /home/hduser/install/hdfsusecases/NYSE_sampledata1.txt
22/06/30 00:47:00 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable


13. Delete the line number 1 from the HDFS file /tmp/hdfsusecases/NYSE_2020_06.txt , for example if the above file
contains 100 rows, after deletion it should have only 99 rows in HDFS
Note: we can’t do this directly because of the WORM property of HDFS data, think about the possible work
around and try to achive the result

Ans:
hadoop fs -copyToLocal /tmp/hdfsusecases/NYSE_2020_06.txt ~/install/hdfsusecases/tmp.txt
sed -i '1d' ~/install/hdfsusecases/tmp.txt
hadoop fs -put ~/install/hdfsusecases/tmp.txt /tmp/hdfsusecases/NYSE_2020_06.txt
rm -rf ~/install/hdfsusecases/tmp.txt

14. Copy the above file /tmp/hdfsusecases/NYSE_2020_06.txt in the name of /tmp/hdfsusecases/NYSE_2020_06_bkp.txt

Ans:
hadoop fs -cp /tmp/hdfsusecases/NYSE_2020_06.txt /tmp/hdfsusecases/NYSE_2020_06_bkp.txt


15. Merge the files in HDFS /tmp/hdfsusecases/NYSE_2020_06.txt and /tmp/hdfsusecases/NYSE_2020_06_bkp.txt
into Linux directory namely ~/install/hdfsusecases/NYSE_2020_06_merged.txt
Note: We have to use the option called -getmerge to achieve this as given below.
hadoop fs -getmerge /tmp/hdfsusecases/NYSE_2020_06_bkp.txt /tmp/hdfsusecases/NYSE_2020_06.txt
~/install/hdfsusecases/NYSE_2020_06_merged.txt

Ans:
hadoop fs -getmerge /tmp/hdfsusecases/NYSE_2020_06_bkp.txt /tmp/hdfsusecases/NYSE_2020_06.txt ~/install/hdfsusecases/NYSE_2020_06_merged.txt


16. Set the blocksize 64MB while writing the file in HDFS, check in the UI how many blocks are generated
hadoop fs -D dfs.block.size=67108864 -put /home/hduser/install/hadoop-2.7.1.tar.gz /user/hduser/

Ans:
hadoop fs -D dfs.block.size=67108864 -put /home/hduser/install/hadoop-2.7.1.tar.gz /user/hduser/

Permission	Owner	Group	Size	Last Modified	Replication	Block Size	Name

drwxr-xr-x	hduser	hadoop	0 B	5/14/2022, 10:35:10 AM	0	0 B	extdata
-rw-r--r--	hduser	hadoop	200.85 MB	6/30/2022, 1:43:05 PM	1	64 MB	hadoop-2.7.1.tar.gz


